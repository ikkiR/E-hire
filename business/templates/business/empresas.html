{% extends "global/base.html" %}
{% load static %}
{% load meus_filtros %}



{% block extra_css %}
    <link rel="stylesheet" href="{% static "global/utils_css/servicos.css" %}">
{% endblock extra_css %}

{% block title %}
    E-Hire - Empresas
{% endblock title %}


{% block nav %}
    <ul>
        <li><a href="{% url 'business:creditos' %}" class="nav-link">Créditos</a></li>
        <li><a href="{% url 'business:servicos' %}" class="nav-link">Home</a></li>
        <li><a href="{% url 'business:solicitacao' %}" class="nav-link">Solicitações</a></li>
    </ul>
{% endblock %}

{% block button_action %}
    <a href="{% url 'business:nova_solicitacao' %}" class="login">Cadastrar novo serviço</a>
    <a href="{% url 'business:ver_perfil' %}" class="signup">perfil</a>
    <div class="credit-display">
        <img src="https://cdn-icons-png.flaticon.com/512/3135/3135715.png" alt="Moeda" class="coin-icon">
        <span class="coin-amount">120</span>
    </div>
{% endblock %}


{% block content %}
    <section id="providers" class="providers-section">
        <form action="{% url 'business:SearchEmpresas' %}" method="GET">
            <div class="filter-bar">
                <div class="search-box">
                    <span class="search-icon">⌕</span>
                    <input type="search" placeholder="Buscar prestadores..." name="q" value="{{request.GET.q.strip}}" aria-label="Buscar prestadores">
                </div>
        </form>
                <div class="filter-options">
                    <form action="{% url 'business:empresas' %}" method="get">
                        <label for="sort-filter-company" class="sr-only">Ordenar por</label>
                        <select id="sort-filter-company" name="ordenacao" class="filter-select" data-filter-type="sort">
                            <option value="default">Ordenar por</option>
                            <option value="rating-desc">Melhor avaliados</option>
                            <option value="rating-asc">Pior avaliados</option>
                        </select>

                        <button type="submit" class="filter-button">Filtrar</button>
                    </form>
                </div>
            </div>
        <div class="cards-container">
            {% for empresa in page_obj %}
                <div class="profile-card" data-category="technology" data-availability="available" data-rating="4.9">
                    <div class="card-header"></div>
                    <div class="card-avatar">
                        {% if empresa.picture %}
                            <img src="{{ empresa.picture.url }}" alt="Foto de perfil de {{ empresa.tradingName }}" loading="lazy">
                        {% else %}
                            <img src="{% static 'global/images/icone_perfil.avif' %}" alt="Logo padrão" loading="lazy">
                        {% endif %}
                    </div>
                    <div class="card-body">
                        <h3 class="card-name">{{ empresa.tradingName }}</h3>
                        <p class="card-title">Desenvolvedor Full Stack</p>
                        <p class="card-bio">{{ empresa.sobre }}</p>
                        <div class="card-skills">
                            <span class="skill-tag">JavaScript</span>
                            <span class="skill-tag">React</span>
                            <span class="skill-tag">Node.js</span>
                            <span class="skill-tag">TypeScript</span>
                            <span class="skill-tag">SQL</span>
                        </div>
                    </div>
                    <div class="card-footer">
                        <div class="card-rating">{{ media_avaliacoes|get_item:empresa.id|default:"0.0" }}</div>{% comment "" %}essa linha chama um filtro que foi criado por mim, onde ele pega a nota de todos os serviços de uma empresa e cria uma média para avaliação total da empresa{% endcomment %}
                        <button class="card-button">Contratar</button>
                    </div>
                </div>
            {% empty %}
                <div class="card_vazio">
                    <p>Oops! Nenhuma empresa foi encontrada</p>
                </div>
            {% endfor %}
        </div>
        {% include "global/paginacao.html" %}
    </section>
{% endblock content %}




{% block script %}
    <script src="{% static 'global/utils_js/servicos.js' %}"></script>
{% endblock %}




